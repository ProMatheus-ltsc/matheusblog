<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>介绍 | Java 全栈知识体系</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="包含: Java 基础, Java 部分源码, JVM, Spring, Spring Boot, Spring Cloud, MySQL, ElasticSearch, MongoDB, Docker, k8s, Linux, DevOps, 分布式, 中间件, 开发工具, Git, IDE, 大数据, 机器学习...">
    
    <link rel="preload" href="/matheusblog/assets/css/0.styles.633991d7.css" as="style"><link rel="preload" href="/matheusblog/assets/js/app.f5c8b815.js" as="script"><link rel="preload" href="/matheusblog/assets/js/2.07d659a0.js" as="script"><link rel="preload" href="/matheusblog/assets/js/183.fb30b0e8.js" as="script"><link rel="prefetch" href="/matheusblog/assets/js/10.92902aa1.js"><link rel="prefetch" href="/matheusblog/assets/js/100.d06e2829.js"><link rel="prefetch" href="/matheusblog/assets/js/101.863619df.js"><link rel="prefetch" href="/matheusblog/assets/js/102.25801d88.js"><link rel="prefetch" href="/matheusblog/assets/js/103.250334dd.js"><link rel="prefetch" href="/matheusblog/assets/js/104.e2973d2b.js"><link rel="prefetch" href="/matheusblog/assets/js/105.2aa40b9e.js"><link rel="prefetch" href="/matheusblog/assets/js/106.075ea7d5.js"><link rel="prefetch" href="/matheusblog/assets/js/107.d6498f6d.js"><link rel="prefetch" href="/matheusblog/assets/js/108.9ff6c792.js"><link rel="prefetch" href="/matheusblog/assets/js/109.484cc692.js"><link rel="prefetch" href="/matheusblog/assets/js/11.19052ec1.js"><link rel="prefetch" href="/matheusblog/assets/js/110.2b588549.js"><link rel="prefetch" href="/matheusblog/assets/js/111.ee922b4c.js"><link rel="prefetch" href="/matheusblog/assets/js/112.1172440b.js"><link rel="prefetch" href="/matheusblog/assets/js/113.d3242014.js"><link rel="prefetch" href="/matheusblog/assets/js/114.2b32dce4.js"><link rel="prefetch" href="/matheusblog/assets/js/115.2b0ca7c9.js"><link rel="prefetch" href="/matheusblog/assets/js/116.64248f33.js"><link rel="prefetch" href="/matheusblog/assets/js/117.5146361f.js"><link rel="prefetch" href="/matheusblog/assets/js/118.4ee2abb8.js"><link rel="prefetch" href="/matheusblog/assets/js/119.00ac2f1a.js"><link rel="prefetch" href="/matheusblog/assets/js/12.c889a8f1.js"><link rel="prefetch" href="/matheusblog/assets/js/120.5d09ed81.js"><link rel="prefetch" href="/matheusblog/assets/js/121.0b4bd5bc.js"><link rel="prefetch" href="/matheusblog/assets/js/122.1968e88a.js"><link rel="prefetch" href="/matheusblog/assets/js/123.00eaf320.js"><link rel="prefetch" href="/matheusblog/assets/js/124.d50606a6.js"><link rel="prefetch" href="/matheusblog/assets/js/125.27ba5ab6.js"><link rel="prefetch" href="/matheusblog/assets/js/126.0fecd9a0.js"><link rel="prefetch" href="/matheusblog/assets/js/127.384c8285.js"><link rel="prefetch" href="/matheusblog/assets/js/128.58b5fa8e.js"><link rel="prefetch" href="/matheusblog/assets/js/129.c2db8ee0.js"><link rel="prefetch" href="/matheusblog/assets/js/13.dd72ba49.js"><link rel="prefetch" href="/matheusblog/assets/js/130.2ceca4f0.js"><link rel="prefetch" href="/matheusblog/assets/js/131.1b7d0765.js"><link rel="prefetch" href="/matheusblog/assets/js/132.36d2f3fb.js"><link rel="prefetch" href="/matheusblog/assets/js/133.ef38c61a.js"><link rel="prefetch" href="/matheusblog/assets/js/134.51751d5e.js"><link rel="prefetch" href="/matheusblog/assets/js/135.02117d70.js"><link rel="prefetch" href="/matheusblog/assets/js/136.e7cdc5f7.js"><link rel="prefetch" href="/matheusblog/assets/js/137.8ab23ef0.js"><link rel="prefetch" href="/matheusblog/assets/js/138.a7501bf7.js"><link rel="prefetch" href="/matheusblog/assets/js/139.ae754d62.js"><link rel="prefetch" href="/matheusblog/assets/js/14.4f9b4097.js"><link rel="prefetch" href="/matheusblog/assets/js/140.d8b7dc9c.js"><link rel="prefetch" href="/matheusblog/assets/js/141.1445694c.js"><link rel="prefetch" href="/matheusblog/assets/js/142.ab9683fd.js"><link rel="prefetch" href="/matheusblog/assets/js/143.7a436eda.js"><link rel="prefetch" href="/matheusblog/assets/js/144.8d94cfbc.js"><link rel="prefetch" href="/matheusblog/assets/js/145.83a028c9.js"><link rel="prefetch" href="/matheusblog/assets/js/146.3c2693ac.js"><link rel="prefetch" href="/matheusblog/assets/js/147.4a29d2fa.js"><link rel="prefetch" href="/matheusblog/assets/js/148.cbd3503c.js"><link rel="prefetch" href="/matheusblog/assets/js/149.de63b365.js"><link rel="prefetch" href="/matheusblog/assets/js/15.1ef92e61.js"><link rel="prefetch" href="/matheusblog/assets/js/150.34b7274f.js"><link rel="prefetch" href="/matheusblog/assets/js/151.ced11234.js"><link rel="prefetch" href="/matheusblog/assets/js/152.4d5c235a.js"><link rel="prefetch" href="/matheusblog/assets/js/153.684ccc3e.js"><link rel="prefetch" href="/matheusblog/assets/js/154.ef6b9585.js"><link rel="prefetch" href="/matheusblog/assets/js/155.15d0d5e8.js"><link rel="prefetch" href="/matheusblog/assets/js/156.d96b541d.js"><link rel="prefetch" href="/matheusblog/assets/js/157.e87c5e53.js"><link rel="prefetch" href="/matheusblog/assets/js/158.6fa16acc.js"><link rel="prefetch" href="/matheusblog/assets/js/159.3b7391ee.js"><link rel="prefetch" href="/matheusblog/assets/js/16.709d432a.js"><link rel="prefetch" href="/matheusblog/assets/js/160.321e8e7f.js"><link rel="prefetch" href="/matheusblog/assets/js/161.f383dbca.js"><link rel="prefetch" href="/matheusblog/assets/js/162.3d5a2f97.js"><link rel="prefetch" href="/matheusblog/assets/js/163.28279d41.js"><link rel="prefetch" href="/matheusblog/assets/js/164.c6958ef4.js"><link rel="prefetch" href="/matheusblog/assets/js/165.bda26fcc.js"><link rel="prefetch" href="/matheusblog/assets/js/166.f43e7f2b.js"><link rel="prefetch" href="/matheusblog/assets/js/167.39a60458.js"><link rel="prefetch" href="/matheusblog/assets/js/168.bdc4f656.js"><link rel="prefetch" href="/matheusblog/assets/js/169.e333e6fc.js"><link rel="prefetch" href="/matheusblog/assets/js/17.687ac65a.js"><link rel="prefetch" href="/matheusblog/assets/js/170.2745f478.js"><link rel="prefetch" href="/matheusblog/assets/js/171.d52cdad9.js"><link rel="prefetch" href="/matheusblog/assets/js/172.f6be93b1.js"><link rel="prefetch" href="/matheusblog/assets/js/173.799700b0.js"><link rel="prefetch" href="/matheusblog/assets/js/174.37f265eb.js"><link rel="prefetch" href="/matheusblog/assets/js/175.804548a8.js"><link rel="prefetch" href="/matheusblog/assets/js/176.93390a3a.js"><link rel="prefetch" href="/matheusblog/assets/js/177.b22c06f9.js"><link rel="prefetch" href="/matheusblog/assets/js/178.d2c13c50.js"><link rel="prefetch" href="/matheusblog/assets/js/179.ca1802ae.js"><link rel="prefetch" href="/matheusblog/assets/js/18.63f9fb90.js"><link rel="prefetch" href="/matheusblog/assets/js/180.dba4e05c.js"><link rel="prefetch" href="/matheusblog/assets/js/181.fd6bcfb4.js"><link rel="prefetch" href="/matheusblog/assets/js/182.e544f08c.js"><link rel="prefetch" href="/matheusblog/assets/js/184.c8db61f0.js"><link rel="prefetch" href="/matheusblog/assets/js/185.a0dd5111.js"><link rel="prefetch" href="/matheusblog/assets/js/186.bb397fcc.js"><link rel="prefetch" href="/matheusblog/assets/js/187.837431e5.js"><link rel="prefetch" href="/matheusblog/assets/js/188.7acc534e.js"><link rel="prefetch" href="/matheusblog/assets/js/189.52b7d00c.js"><link rel="prefetch" href="/matheusblog/assets/js/19.5f158fe1.js"><link rel="prefetch" href="/matheusblog/assets/js/190.71130651.js"><link rel="prefetch" href="/matheusblog/assets/js/191.d1e24979.js"><link rel="prefetch" href="/matheusblog/assets/js/192.7577b246.js"><link rel="prefetch" href="/matheusblog/assets/js/193.e6d1dd15.js"><link rel="prefetch" href="/matheusblog/assets/js/194.88dc93f1.js"><link rel="prefetch" href="/matheusblog/assets/js/195.3f3f2f7d.js"><link rel="prefetch" href="/matheusblog/assets/js/196.27acd427.js"><link rel="prefetch" href="/matheusblog/assets/js/197.b349c59f.js"><link rel="prefetch" href="/matheusblog/assets/js/198.4e1a17d9.js"><link rel="prefetch" href="/matheusblog/assets/js/199.171e9c61.js"><link rel="prefetch" href="/matheusblog/assets/js/20.592ab894.js"><link rel="prefetch" href="/matheusblog/assets/js/200.fc01f9b0.js"><link rel="prefetch" href="/matheusblog/assets/js/201.0bcbf444.js"><link rel="prefetch" href="/matheusblog/assets/js/202.8ca5f069.js"><link rel="prefetch" href="/matheusblog/assets/js/203.6ed997bd.js"><link rel="prefetch" href="/matheusblog/assets/js/204.ce690218.js"><link rel="prefetch" href="/matheusblog/assets/js/205.90aad4e1.js"><link rel="prefetch" href="/matheusblog/assets/js/206.5899106f.js"><link rel="prefetch" href="/matheusblog/assets/js/207.951f99f8.js"><link rel="prefetch" href="/matheusblog/assets/js/208.ee335b0e.js"><link rel="prefetch" href="/matheusblog/assets/js/209.bfef7887.js"><link rel="prefetch" href="/matheusblog/assets/js/21.5cf219e6.js"><link rel="prefetch" href="/matheusblog/assets/js/210.63158502.js"><link rel="prefetch" href="/matheusblog/assets/js/211.f250495e.js"><link rel="prefetch" href="/matheusblog/assets/js/212.70cf7966.js"><link rel="prefetch" href="/matheusblog/assets/js/213.9b0cf8dd.js"><link rel="prefetch" href="/matheusblog/assets/js/214.e4d7a9f2.js"><link rel="prefetch" href="/matheusblog/assets/js/215.aafcb0dc.js"><link rel="prefetch" href="/matheusblog/assets/js/216.7e5bf171.js"><link rel="prefetch" href="/matheusblog/assets/js/217.4f9e7265.js"><link rel="prefetch" href="/matheusblog/assets/js/218.1b0ddc43.js"><link rel="prefetch" href="/matheusblog/assets/js/219.99d6ed0f.js"><link rel="prefetch" href="/matheusblog/assets/js/22.ad294ffc.js"><link rel="prefetch" href="/matheusblog/assets/js/220.069b4416.js"><link rel="prefetch" href="/matheusblog/assets/js/221.6d23c4a4.js"><link rel="prefetch" href="/matheusblog/assets/js/23.f249d020.js"><link rel="prefetch" href="/matheusblog/assets/js/24.57042743.js"><link rel="prefetch" href="/matheusblog/assets/js/25.71ac837e.js"><link rel="prefetch" href="/matheusblog/assets/js/26.825ff489.js"><link rel="prefetch" href="/matheusblog/assets/js/27.9ce93db5.js"><link rel="prefetch" href="/matheusblog/assets/js/28.b60008c0.js"><link rel="prefetch" href="/matheusblog/assets/js/29.78376b50.js"><link rel="prefetch" href="/matheusblog/assets/js/3.9d382916.js"><link rel="prefetch" href="/matheusblog/assets/js/30.5b5c579c.js"><link rel="prefetch" href="/matheusblog/assets/js/31.79404db0.js"><link rel="prefetch" href="/matheusblog/assets/js/32.81681a37.js"><link rel="prefetch" href="/matheusblog/assets/js/33.e2566ea5.js"><link rel="prefetch" href="/matheusblog/assets/js/34.17450872.js"><link rel="prefetch" href="/matheusblog/assets/js/35.8bf79814.js"><link rel="prefetch" href="/matheusblog/assets/js/36.0cf1ff24.js"><link rel="prefetch" href="/matheusblog/assets/js/37.a0d0aa37.js"><link rel="prefetch" href="/matheusblog/assets/js/38.47a9a315.js"><link rel="prefetch" href="/matheusblog/assets/js/39.1c092321.js"><link rel="prefetch" href="/matheusblog/assets/js/4.67cf97f1.js"><link rel="prefetch" href="/matheusblog/assets/js/40.08d9f488.js"><link rel="prefetch" href="/matheusblog/assets/js/41.d0aca1ba.js"><link rel="prefetch" href="/matheusblog/assets/js/42.6d92c7e9.js"><link rel="prefetch" href="/matheusblog/assets/js/43.d8bca60d.js"><link rel="prefetch" href="/matheusblog/assets/js/44.a762cb9f.js"><link rel="prefetch" href="/matheusblog/assets/js/45.7e4f224a.js"><link rel="prefetch" href="/matheusblog/assets/js/46.6cdf6467.js"><link rel="prefetch" href="/matheusblog/assets/js/47.1226b40b.js"><link rel="prefetch" href="/matheusblog/assets/js/48.91257bcf.js"><link rel="prefetch" href="/matheusblog/assets/js/49.004cd9b1.js"><link rel="prefetch" href="/matheusblog/assets/js/5.67991b56.js"><link rel="prefetch" href="/matheusblog/assets/js/50.ab357dd2.js"><link rel="prefetch" href="/matheusblog/assets/js/51.b0682a7e.js"><link rel="prefetch" href="/matheusblog/assets/js/52.90b17642.js"><link rel="prefetch" href="/matheusblog/assets/js/53.06d84907.js"><link rel="prefetch" href="/matheusblog/assets/js/54.e103ce4f.js"><link rel="prefetch" href="/matheusblog/assets/js/55.44e83d8c.js"><link rel="prefetch" href="/matheusblog/assets/js/56.865c7d3e.js"><link rel="prefetch" href="/matheusblog/assets/js/57.b6757822.js"><link rel="prefetch" href="/matheusblog/assets/js/58.9ae99739.js"><link rel="prefetch" href="/matheusblog/assets/js/59.25279d4c.js"><link rel="prefetch" href="/matheusblog/assets/js/6.dc12a256.js"><link rel="prefetch" href="/matheusblog/assets/js/60.4201f1b7.js"><link rel="prefetch" href="/matheusblog/assets/js/61.9762b05f.js"><link rel="prefetch" href="/matheusblog/assets/js/62.ce5bd23a.js"><link rel="prefetch" href="/matheusblog/assets/js/63.16bbda41.js"><link rel="prefetch" href="/matheusblog/assets/js/64.594f3e6e.js"><link rel="prefetch" href="/matheusblog/assets/js/65.550baa39.js"><link rel="prefetch" href="/matheusblog/assets/js/66.974c4406.js"><link rel="prefetch" href="/matheusblog/assets/js/67.8ff3e072.js"><link rel="prefetch" href="/matheusblog/assets/js/68.dcf15b6a.js"><link rel="prefetch" href="/matheusblog/assets/js/69.9c048d71.js"><link rel="prefetch" href="/matheusblog/assets/js/7.c5287b0b.js"><link rel="prefetch" href="/matheusblog/assets/js/70.eb79f1af.js"><link rel="prefetch" href="/matheusblog/assets/js/71.ef5430ec.js"><link rel="prefetch" href="/matheusblog/assets/js/72.9ae4fdea.js"><link rel="prefetch" href="/matheusblog/assets/js/73.8f8accb1.js"><link rel="prefetch" href="/matheusblog/assets/js/74.e6d71209.js"><link rel="prefetch" href="/matheusblog/assets/js/75.253f5d01.js"><link rel="prefetch" href="/matheusblog/assets/js/76.268db809.js"><link rel="prefetch" href="/matheusblog/assets/js/77.4e8e87a6.js"><link rel="prefetch" href="/matheusblog/assets/js/78.38053154.js"><link rel="prefetch" href="/matheusblog/assets/js/79.6a55897f.js"><link rel="prefetch" href="/matheusblog/assets/js/8.73b6c017.js"><link rel="prefetch" href="/matheusblog/assets/js/80.15f93b29.js"><link rel="prefetch" href="/matheusblog/assets/js/81.e139f318.js"><link rel="prefetch" href="/matheusblog/assets/js/82.c723e75a.js"><link rel="prefetch" href="/matheusblog/assets/js/83.1e0d11ec.js"><link rel="prefetch" href="/matheusblog/assets/js/84.17553570.js"><link rel="prefetch" href="/matheusblog/assets/js/85.11d4835a.js"><link rel="prefetch" href="/matheusblog/assets/js/86.52516a13.js"><link rel="prefetch" href="/matheusblog/assets/js/87.58f3806e.js"><link rel="prefetch" href="/matheusblog/assets/js/88.907458c5.js"><link rel="prefetch" href="/matheusblog/assets/js/89.b32ce6c5.js"><link rel="prefetch" href="/matheusblog/assets/js/9.40b50737.js"><link rel="prefetch" href="/matheusblog/assets/js/90.47afc03f.js"><link rel="prefetch" href="/matheusblog/assets/js/91.a50a8c8f.js"><link rel="prefetch" href="/matheusblog/assets/js/92.2b286aa5.js"><link rel="prefetch" href="/matheusblog/assets/js/93.93dcc5de.js"><link rel="prefetch" href="/matheusblog/assets/js/94.cbc46dbe.js"><link rel="prefetch" href="/matheusblog/assets/js/95.eacd106d.js"><link rel="prefetch" href="/matheusblog/assets/js/96.f9b553c0.js"><link rel="prefetch" href="/matheusblog/assets/js/97.a0a65321.js"><link rel="prefetch" href="/matheusblog/assets/js/98.ba3fc9ed.js"><link rel="prefetch" href="/matheusblog/assets/js/99.dd78b0d0.js">
    <link rel="stylesheet" href="/matheusblog/assets/css/0.styles.633991d7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/matheusblog/" class="home-link router-link-active"><!----> <span class="site-name">Java 全栈知识体系</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Menu" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java Menu" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/basic/helloworld.html" class="nav-link">
  认识编程
</a></li></ul></li><li class="dropdown-item"><h4>
          集合
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/collection/泛型和集合.html" class="nav-link">
  泛型和集合
</a></li></ul></li><li class="dropdown-item"><h4>
          IO
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/io/IO.html" class="nav-link">
  IO
</a></li></ul></li><li class="dropdown-item"><h4>
          并发编程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/thread/多线程.html" class="nav-link">
  多线程
</a></li></ul></li><li class="dropdown-item"><h4>
          JVM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/basic/helloworld.html" class="nav-link">
  认识编程
</a></li></ul></li><li class="dropdown-item"><h4>
          Java新特性
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/basic/helloworld.html" class="nav-link">
  认识编程
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web Menu" class="dropdown-title"><span class="title">Web基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web Menu" class="mobile-dropdown-title"><span class="title">Web基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          HTML5
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/web/html5/01HTML概述.html" class="nav-link">
  HTML概述
</a></li></ul></li><li class="dropdown-item"><h4>
          CSS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/web/css/01基础选择器+字体文本样式.html" class="nav-link">
  基础选择器+字体文本样式
</a></li></ul></li><li class="dropdown-item"><h4>
          JS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/web/js/01JavaScript基础.html" class="nav-link">
  JavaScript基础
</a></li></ul></li><li class="dropdown-item"><h4>
          VUE
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/web/vue/01Vue简介与安装使用.html" class="nav-link">
  Vue简介与安装使用
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="database Menu" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="database Menu" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          MySQL
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/db/mysql/01数据库软件的安装与使用.html" class="nav-link">
  数据库软件的安装与使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Redis
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          MongoDB
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/db/mongodb/01数据库和集合基本操作.html" class="nav-link">
  数据库和集合基本操作
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="SpringFramework Menu" class="dropdown-title"><span class="title">SpringFramework</span> <span class="arrow down"></span></button> <button type="button" aria-label="SpringFramework Menu" class="mobile-dropdown-title"><span class="title">SpringFramework</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Maven
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Spring
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/spring/Spring概述.html" class="nav-link">
  Spring概述
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringMVC
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/springmvc/01SpringMVC简介.html" class="nav-link">
  SpringMVC简介
</a></li></ul></li><li class="dropdown-item"><h4>
          MyBatis-plus
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/mybatis/01MyBatis简介.html" class="nav-link">
  MyBatis简介
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringBoot
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/matheusblog/md/project/jt-project/problem.html" class="nav-link">
  项目
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Devops Menu" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="Devops Menu" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          linux
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/devops/linux/00 Centos.html" class="nav-link">
  CentOS
</a></li></ul></li><li class="dropdown-item"><h4>
          tools
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/devops/tools/VS Code使用.html" class="nav-link">
  VS Code使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Docker
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          k8s
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Hadoop
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/matheusblog/md/springcloud/note.html" class="nav-link">
  SpringCloud
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="develop Menu" class="dropdown-title"><span class="title">开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="develop Menu" class="mobile-dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          代码规范
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          开发环境
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/develop/JUnit/01什么是单元测试.html" class="nav-link">
  开发部署
</a></li></ul></li><li class="dropdown-item"><h4>
          部署环境
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/develop/pattern/设计模式.html" class="nav-link">
  部署部署
</a></li></ul></li><li class="dropdown-item"><h4>
          设计模式
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/develop/pattern/设计模式.html" class="nav-link">
  设计模式
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/matheusblog/md/arch/计算机软件架构发展历史.html" class="nav-link">
  架构
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="other-languages Menu" class="dropdown-title"><span class="title">其他语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="other-languages Menu" class="mobile-dropdown-title"><span class="title">其他语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Go
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/other-languages/go/01Go语言介绍.html" class="nav-link">
  Go语言介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          Scala
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Python
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="algorithm Menu" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="algorithm Menu" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据结构
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Spark基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          机器学习
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java Menu" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java Menu" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/basic/helloworld.html" class="nav-link">
  认识编程
</a></li></ul></li><li class="dropdown-item"><h4>
          集合
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/collection/泛型和集合.html" class="nav-link">
  泛型和集合
</a></li></ul></li><li class="dropdown-item"><h4>
          IO
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/io/IO.html" class="nav-link">
  IO
</a></li></ul></li><li class="dropdown-item"><h4>
          并发编程
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/thread/多线程.html" class="nav-link">
  多线程
</a></li></ul></li><li class="dropdown-item"><h4>
          JVM
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/basic/helloworld.html" class="nav-link">
  认识编程
</a></li></ul></li><li class="dropdown-item"><h4>
          Java新特性
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/java/basic/helloworld.html" class="nav-link">
  认识编程
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Web Menu" class="dropdown-title"><span class="title">Web基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="Web Menu" class="mobile-dropdown-title"><span class="title">Web基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          HTML5
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/web/html5/01HTML概述.html" class="nav-link">
  HTML概述
</a></li></ul></li><li class="dropdown-item"><h4>
          CSS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/web/css/01基础选择器+字体文本样式.html" class="nav-link">
  基础选择器+字体文本样式
</a></li></ul></li><li class="dropdown-item"><h4>
          JS
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/web/js/01JavaScript基础.html" class="nav-link">
  JavaScript基础
</a></li></ul></li><li class="dropdown-item"><h4>
          VUE
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/web/vue/01Vue简介与安装使用.html" class="nav-link">
  Vue简介与安装使用
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="database Menu" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="database Menu" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          MySQL
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/db/mysql/01数据库软件的安装与使用.html" class="nav-link">
  数据库软件的安装与使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Redis
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          MongoDB
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/db/mongodb/01数据库和集合基本操作.html" class="nav-link">
  数据库和集合基本操作
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="SpringFramework Menu" class="dropdown-title"><span class="title">SpringFramework</span> <span class="arrow down"></span></button> <button type="button" aria-label="SpringFramework Menu" class="mobile-dropdown-title"><span class="title">SpringFramework</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Maven
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Spring
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/spring/Spring概述.html" class="nav-link">
  Spring概述
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringMVC
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/springmvc/01SpringMVC简介.html" class="nav-link">
  SpringMVC简介
</a></li></ul></li><li class="dropdown-item"><h4>
          MyBatis-plus
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/mybatis/01MyBatis简介.html" class="nav-link">
  MyBatis简介
</a></li></ul></li><li class="dropdown-item"><h4>
          SpringBoot
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/matheusblog/md/project/jt-project/problem.html" class="nav-link">
  项目
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Devops Menu" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="Devops Menu" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          linux
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/devops/linux/00 Centos.html" class="nav-link">
  CentOS
</a></li></ul></li><li class="dropdown-item"><h4>
          tools
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/devops/tools/VS Code使用.html" class="nav-link">
  VS Code使用
</a></li></ul></li><li class="dropdown-item"><h4>
          Docker
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          k8s
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Hadoop
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/matheusblog/md/springcloud/note.html" class="nav-link">
  SpringCloud
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="develop Menu" class="dropdown-title"><span class="title">开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="develop Menu" class="mobile-dropdown-title"><span class="title">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          代码规范
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          开发环境
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/develop/JUnit/01什么是单元测试.html" class="nav-link">
  开发部署
</a></li></ul></li><li class="dropdown-item"><h4>
          部署环境
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/develop/pattern/设计模式.html" class="nav-link">
  部署部署
</a></li></ul></li><li class="dropdown-item"><h4>
          设计模式
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/develop/pattern/设计模式.html" class="nav-link">
  设计模式
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/matheusblog/md/arch/计算机软件架构发展历史.html" class="nav-link">
  架构
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="other-languages Menu" class="dropdown-title"><span class="title">其他语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="other-languages Menu" class="mobile-dropdown-title"><span class="title">其他语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Go
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/other-languages/go/01Go语言介绍.html" class="nav-link">
  Go语言介绍
</a></li></ul></li><li class="dropdown-item"><h4>
          Scala
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Python
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="algorithm Menu" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="algorithm Menu" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          数据结构
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          Spark基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li><li class="dropdown-item"><h4>
          机器学习
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="nav-link">
  Maven入门基础
</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Maven</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/matheusblog/md/spring/maven/01Tomcat入门基础.html" class="sidebar-link">Tomcat入门基础</a></li><li><a href="/matheusblog/md/spring/maven/02Maven入门基础.html" class="sidebar-link">Maven入门基础</a></li><li><a href="/matheusblog/md/spring/maven/03Maven pom.xml常用配置.html" class="sidebar-link">Maven的pox.xml常用配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spring</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/matheusblog/md/spring/spring/Spring概述.html" class="sidebar-link">Spring概述</a></li><li><a href="/matheusblog/md/spring/spring/Spring入门案例.html" class="sidebar-link">Spring入门案例</a></li><li><a href="/matheusblog/md/spring/spring/IOC控制反转.html" class="sidebar-link">IOC控制反转</a></li><li><a href="/matheusblog/md/spring/spring/DI依赖注入.html" class="sidebar-link">DI依赖注入</a></li><li><a href="/matheusblog/md/spring/spring/Bean工厂.html" class="sidebar-link">Bean工厂</a></li><li><a href="/matheusblog/md/spring/spring/AOP面向切面编程.html" class="sidebar-link">AOP面向切面编程</a></li><li><a href="/matheusblog/md/spring/spring/事务控制.html" class="sidebar-link">事务控制</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>SpringMVC</span> <!----></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MyBatis-Plus</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/matheusblog/md/spring/mybatis/01MyBatis简介.html" class="sidebar-link">MyBatis简介</a></li><li><a href="/matheusblog/md/spring/mybatis/02入门程序.html" class="sidebar-link">MyBatis入门程序</a></li><li><a href="/matheusblog/md/spring/mybatis/03MyBatis框架.html" class="sidebar-link">MyBatis框架</a></li><li><a href="/matheusblog/md/spring/mybatis/04MyBatis-Plus.html" class="sidebar-link">MyBatis-Plus</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <p>假设这样的情况，一个网络商场的一台服务器每秒能处理 40 单下单请求，但是商场搞促销活动的时候，短短几个小时间每秒的下单请求可能能到 400 单，虽然可以通过把服务器增加到十台这样的方式来处理高峰期时间的下单请求，但是平时也维持 10 台服务器的话却会大大增加运营成本。在这种情况下，消息中间件的作用就会被体现出来。</p> <p>RabbitMQ 是一种应用非常广泛的开源消息中间件，接下来将学习如何在 SpringBoot 中使用 RabbitMQ。</p> <p>通过代码示例演示基于直接队列模式、分列模式、主题模式、延迟队列的消息发送和接收。</p> <h3 id="rabbitmq-工作原理"><a href="#rabbitmq-工作原理" class="header-anchor">#</a> RabbitMQ 工作原理</h3> <p>关于 RabbitMQ，可以用一张图来概括它的工作模式：</p> <p><img src="https://doc.shiyanlou.com/courses/3055/1468386/06fd50b1923ff543211eb44ca723ecc1-0" alt="图片描述"></p> <p>可以看到，生产者是消息推送者，发送消息到 RabbitMQ 服务器中，经过交换机、队列后，最终发送到消费者，也就是消息接收者。</p> <p>RabbitMQ 中交换机的概念和计算机网络中网络层的路由器概念其实非常相似，它一边可以从多个生产者那接受消息，另外一边可以将消息推送到队列。交换机必须知道如何处理它接受的消息，是应该推送到指定队列还是推送到多个队列。</p> <p>常用的交换机有以下三种：</p> <ol><li><p><strong>Direct Exchange</strong>：直连型交换机，是默认的交换机类型。它的工作原理是将消息推送到路由键匹配的队列中，关于路由键的设会在后面的实例演示中讲解。</p></li> <li><p><strong>Fanout Exchange</strong>：扇形交换机，这个交换机没有路由键的概念，它会将消息广播到所有附加到这个交换机的队列上。使用这种交换机，可以完成消息的发布/订阅。</p></li> <li><p><strong>Topic Exchange</strong>：主题交换机，它与扇形交换机类似，但是，它可以使用 <strong>routingKey —— 路由键</strong>进行消息匹配，使得消费者可以灵活地订阅想要接受的主题的消息。routingKey 使用下面的字符匹配消息：</p> <ul><li><code>*</code> 匹配一个分段（用 &quot;.&quot; 分割）的内容</li> <li><code>#</code> 匹配 0 和多个字符</li></ul> <p>具体使用，在接下来的演示中大家会了解到。</p></li></ol> <p>有了交换机，就会有对应的消息发送模式，RabbitMQ 官网介绍了六种消息发送模式：<a href="https://www.rabbitmq.com/getstarted.html" target="_blank" rel="noopener noreferrer">RabbitMQ Tutorials<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li><p>Simple Work Queue （简单工作队列）：也就是常说的点对点模式，一条消息由一个消费者进行消费。（当有多个消费者时，默认使用轮训机制把消息分配给消费者）。</p></li> <li><p>Work Queues （工作队列）：也叫公平队列，能者多劳的消息队列模型。队列必须接收到来自消费者的手动 ack 才可以继续往消费者发送消息。</p></li> <li><p>Publish/Subscribe （发布订阅模式）：一条消息被多个消费者消费。</p></li> <li><p>Routing（路由模式）：有选择的接收消息。</p></li> <li><p>Topics （主题模式）：通过一定的规则来选择性的接收消息</p></li> <li><p>RPC 模式：发布者发布消息，并且通过 RPC 方式等待结果。目前这个应该场景少，而且代码也较为复杂，就不做讲解了。</p> <blockquote><p><strong>注意</strong>：官网最后的 Publisher Confirms 为消息确认机制。指的是生产者如何发送可靠的消息。</p></blockquote></li></ul> <p>这样，就可以总结出每种模式对应需要使用的交换机：</p> <table><thead><tr><th>消息模式</th> <th>交换机</th></tr></thead> <tbody><tr><td>简单消息模式</td> <td>空交换机</td></tr> <tr><td>发布/订阅模式</td> <td>扇形交换机</td></tr> <tr><td>路由模式</td> <td>直连交换机</td></tr> <tr><td>主题模式</td> <td>主题交换机</td></tr></tbody></table> <p>接下来就是我们的实例演示环节。</p> <h3 id=""><a href="#" class="header-anchor">#</a></h3> <h2 id="安装-rabbitmq"><a href="#安装-rabbitmq" class="header-anchor">#</a> 安装 RabbitMQ</h2> <p>自 Debian since 6.0 (squeeze) 和 Ubuntu 9.04 之后，rabbitmq-server 就在 Ubuntu 的官方源里面了，但是如果你想安装最新版本，可以在官网下载，或者使用官方提供的源来安装。本次实验我们就用 Ubuntu 源里的版本安装，所有的依赖都可以被自动安装。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo apt-get update
sudo apt-get install rabbitmq-server
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="启动-rabbitmq"><a href="#启动-rabbitmq" class="header-anchor">#</a> 启动 RabbitMQ</h2> <p>当 RabbitMQ 安装完毕的时候服务器就会像后台程序一般运行起来了。</p> <p>服务器相关命令：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>启动：sudo service rabbitmq-server start
关闭： sudo service rabbitmq-server stop
查看状态：sudo service rabbitmq-server status
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="新建项目"><a href="#新建项目" class="header-anchor">#</a> 新建项目</h2> <p>由于 maven 下载包需要联网，这里先将 maven 包下载下来，放到本地仓库便可以解决联网的问题</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>wget http://labfile.oss.aliyuncs.com/courses/1152/m2.zip
unzip m2.zip
mv .m2 /home/shiyanlou/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>首先需要新建一个 SpringBoot 项目，具体步骤可以查看前面的章节，这里不再赘述。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mvn archetype:generate -DgroupId=com.shiyanlou -DartifactId=rabbit -DarchetypeArtifactId=maven-archetype-quickstart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>最后形成下面的目录结构：</p> <p><img src="https://doc.shiyanlou.com/document-uid441493labid8432timestamp1548914014086.png/wm" alt="img"></p> <h2 id="添加依赖"><a href="#添加依赖" class="header-anchor">#</a> 添加依赖</h2> <p>在使用 Spring 发送和接收 RabbitMQ 消息之前，需要将 Spring Boot 的 AMQP starter 依赖添加到构建文件中，这个依赖会创建一个 AMQP 连接工厂和 RabbitTemplate bean.</p> <p>Spring Boot 整合 RabbitMQ 只要添加这项依赖就可以了：</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>修改 pom.xml，添加下面的依赖</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.1.2.RELEASE&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;com.shiyanlou&lt;/groupId&gt;
    &lt;artifactId&gt;rabbit&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;rabbit&lt;/name&gt;

    &lt;properties&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;

        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="配置-rabbitmq"><a href="#配置-rabbitmq" class="header-anchor">#</a> 配置 RabbitMQ</h2> <h3 id="第一种"><a href="#第一种" class="header-anchor">#</a> 第一种</h3> <p>当需要把应用程序投入生产环境时，就需要认证的 RabbitMQ 代理，它运行在本地机器上并监听 5672 端口。所以需要一个配置文件来配置这些属性。</p> <p>在 <code>src/main/resources</code> 建立一个 YAML 配置文件 <code>application.yml</code> ，并添加如下的配置信息。</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">servlet</span><span class="token punctuation">:</span>
    <span class="token key atrule">context-path</span><span class="token punctuation">:</span> /example
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> localhost
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
    <span class="token key atrule">password</span><span class="token punctuation">:</span> guest
    <span class="token key atrule">virtual-host</span><span class="token punctuation">:</span> /
    <span class="token comment"># 手动提交ack消息</span>
    <span class="token key atrule">listener</span><span class="token punctuation">:</span>
      <span class="token key atrule">simple</span><span class="token punctuation">:</span>
        <span class="token key atrule">acknowledge-mode</span><span class="token punctuation">:</span> manual
      <span class="token key atrule">direct</span><span class="token punctuation">:</span>
        <span class="token key atrule">acknowledge-mode</span><span class="token punctuation">:</span> manual
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><code>guest</code> 是 RabbitMQ 代理默认的账号和密码。</p> <p>这样，RabbitMQ 就整合进了 Spring Boot 环境中。</p> <h3 id="第二种"><a href="#第二种" class="header-anchor">#</a> 第二种</h3> <p>在src/main/resources中的 application.properties 配置文件中添加以下配置</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token comment"># rabbitmq地址</span>
spring.rabbitmq.host=localhost
<span class="token comment"># 用户名</span>
spring.rabbitmq.username=guest
<span class="token comment"># 密码</span>
spring.rabbitmq.password=guest
<span class="token comment"># 端口</span>
spring.rabbitmq.port=5672
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="创建常量池"><a href="#创建常量池" class="header-anchor">#</a> 创建常量池</h2> <p>接下来，将演示多种发送消息的模式，在 <code>com.example.mq.rabbitmq.constants</code> 下先创建一个 RabbitMQ 常量池 <code>RabbitConsts.java</code> ，我们将使用这个常量池，规定一些队列、交换机和路由键的名称：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>constants</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * RabbitMQ 常量池
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">RabbitConsts</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 直接模式1
     */</span>
    <span class="token class-name">String</span> DIRECT_MODE_QUEUE_ONE <span class="token operator">=</span> <span class="token string">&quot;queue.direct.1&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 队列2
     */</span>
    <span class="token class-name">String</span> QUEUE_TWO <span class="token operator">=</span> <span class="token string">&quot;queue.2&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 队列3
     */</span>
    <span class="token class-name">String</span> QUEUE_THREE <span class="token operator">=</span> <span class="token string">&quot;3.queue&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 分列模式
     */</span>
    <span class="token class-name">String</span> FANOUT_MODE_QUEUE <span class="token operator">=</span> <span class="token string">&quot;fanout.mode&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 主题模式
     */</span>
    <span class="token class-name">String</span> TOPIC_MODE_QUEUE <span class="token operator">=</span> <span class="token string">&quot;topic.mode&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 路由1
     */</span>
    <span class="token class-name">String</span> TOPIC_ROUTING_KEY_ONE <span class="token operator">=</span> <span class="token string">&quot;queue.#&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 路由2
     */</span>
    <span class="token class-name">String</span> TOPIC_ROUTING_KEY_TWO <span class="token operator">=</span> <span class="token string">&quot;*.queue&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 路由3
     */</span>
    <span class="token class-name">String</span> TOPIC_ROUTING_KEY_THREE <span class="token operator">=</span> <span class="token string">&quot;3.queue&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>可以看到路由键 1 和路由键 2 分别为 <code>queue.#</code> 和 <code>*.queue</code>，而队列 2 和队列 3 分别为 <code>queue.2</code> 和 <code>3.queue</code> 并将其作为组件添加进 Spring Boot 项目的时候，对应的路由和队列就会进行匹配。</p> <h2 id="创建配置类"><a href="#创建配置类" class="header-anchor">#</a> 创建配置类</h2> <p>在上一小节，使用常量池的形式规定了一些队列，主题和路由键的名称，这一节，就需要配置对应的方法，并且使用 <code>@Bean</code> 对其注释，使其作为组件能够添加进 Spring Boot 中。</p> <p>配置队列，实现如下方法向容器中添加一个 queueName 组件，形式如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queueName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;队列名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>同理，对应的交换机也使用返回 <code>FanoutExchange</code> 类和 <code>TopicExchange</code> 类的方法来完成：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FanoutExchange</span> <span class="token function">fanoutExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FanoutExchange</span><span class="token punctuation">(</span><span class="token string">&quot;交换机名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TopicExchange</span> <span class="token function">topicExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TopicExchange</span><span class="token punctuation">(</span><span class="token string">&quot;交换机名&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>最后还需要配置一个返回 <code>RabbitTemplate</code> 类的方法，Spring 对 RabbitMQ 消息支持的核心是 <code>RabbitTemplate</code> ，它是一个简化消息访问的助手类。具体实现形式如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RabbitTemplate</span> <span class="token function">rabbitTemplate</span><span class="token punctuation">(</span><span class="token class-name">CachingConnectionFactory</span> connectionFactory<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// RabbitTemplate使用CachingConnectionFactory作为连接工厂</span>
        <span class="token comment">// 使用完整的(相关的)publisher确认，并使用相关数据和每个消息的返回</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPublisherConfirms</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPublisherReturns</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 构造器</span>
        <span class="token class-name">RabbitTemplate</span> rabbitTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RabbitTemplate</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 在发送消息时设置强制标识，使其返回消息发送成功或丢失的消息</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setMandatory</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setConfirmCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>correlationData<span class="token punctuation">,</span> ack<span class="token punctuation">,</span> cause<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;消息发送成功:correlationData({}),ack({}),cause({})&quot;</span><span class="token punctuation">,</span> correlationData<span class="token punctuation">,</span> ack<span class="token punctuation">,</span> cause<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setReturnCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> replyCode<span class="token punctuation">,</span> replyText<span class="token punctuation">,</span> exchange<span class="token punctuation">,</span> routingKey<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;消息丢失:exchange({}),route({}),replyCode({}),replyText({}),message:{}&quot;</span><span class="token punctuation">,</span> exchange<span class="token punctuation">,</span> routingKey<span class="token punctuation">,</span> replyCode<span class="token punctuation">,</span> replyText<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> rabbitTemplate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>最后 <code>com.example.mq.rabbitmq.config</code> 中配置类文件 <code>RabbitMqConfig.java</code> 的完整代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>constants<span class="token punctuation">.</span></span><span class="token class-name">RabbitConsts</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>connection<span class="token punctuation">.</span></span><span class="token class-name">CachingConnectionFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RabbitTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * RabbitMQ 配置类
 */</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMqConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RabbitTemplate</span> <span class="token function">rabbitTemplate</span><span class="token punctuation">(</span><span class="token class-name">CachingConnectionFactory</span> connectionFactory<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// RabbitTemplate使用CachingConnectionFactory作为连接工厂</span>
        <span class="token comment">// 使用完整的(相关的)publisher确认，并使用相关数据和每个消息的返回</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPublisherConfirms</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPublisherReturns</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 构造器</span>
        <span class="token class-name">RabbitTemplate</span> rabbitTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RabbitTemplate</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 在发送消息时设置强制标识，使其返回消息发送成功或丢失的消息</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setMandatory</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setConfirmCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>correlationData<span class="token punctuation">,</span> ack<span class="token punctuation">,</span> cause<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;消息发送成功:correlationData({}),ack({}),cause({})&quot;</span><span class="token punctuation">,</span> correlationData<span class="token punctuation">,</span> ack<span class="token punctuation">,</span> cause<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">setReturnCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> replyCode<span class="token punctuation">,</span> replyText<span class="token punctuation">,</span> exchange<span class="token punctuation">,</span> routingKey<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;消息丢失:exchange({}),route({}),replyCode({}),replyText({}),message:{}&quot;</span><span class="token punctuation">,</span> exchange<span class="token punctuation">,</span> routingKey<span class="token punctuation">,</span> replyCode<span class="token punctuation">,</span> replyText<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> rabbitTemplate<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 直接模式队列1
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">directOneQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>DIRECT_MODE_QUEUE_ONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 队列2
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queueTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>QUEUE_TWO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 队列3
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Queue</span> <span class="token function">queueThree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>QUEUE_THREE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 分列模式队列
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FanoutExchange</span> <span class="token function">fanoutExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FanoutExchange</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>FANOUT_MODE_QUEUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 分列模式绑定队列1
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">fanoutBinding1</span><span class="token punctuation">(</span><span class="token class-name">Queue</span> directOneQueue<span class="token punctuation">,</span> <span class="token class-name">FanoutExchange</span> fanoutExchange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>directOneQueue<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>fanoutExchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 分列模式绑定队列2
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">fanoutBinding2</span><span class="token punctuation">(</span><span class="token class-name">Queue</span> queueTwo<span class="token punctuation">,</span> <span class="token class-name">FanoutExchange</span> fanoutExchange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>queueTwo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>fanoutExchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 主题模式队列
     * &lt;li&gt;路由格式必须以 . 分隔，比如 user.email 或者 user.aaa.email&lt;/li&gt;
     * &lt;li&gt;通配符 * ，代表一个占位符，或者说一个单词，比如路由为 user.*，那么 user.email 可以匹配，但是 user.aaa.email 就匹配不了&lt;/li&gt;
     * &lt;li&gt;通配符 # ，代表一个或多个占位符，或者说一个或多个单词，比如路由为 user.#，那么 user.email 可以匹配，user.aaa.email 也可以匹配&lt;/li&gt;
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">TopicExchange</span> <span class="token function">topicExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TopicExchange</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>TOPIC_MODE_QUEUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 主题模式绑定分列模式
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">topicBinding1</span><span class="token punctuation">(</span><span class="token class-name">FanoutExchange</span> fanoutExchange<span class="token punctuation">,</span> <span class="token class-name">TopicExchange</span> topicExchange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>fanoutExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>topicExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>TOPIC_ROUTING_KEY_ONE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 主题模式绑定队列2
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">topicBinding2</span><span class="token punctuation">(</span><span class="token class-name">Queue</span> queueTwo<span class="token punctuation">,</span> <span class="token class-name">TopicExchange</span> topicExchange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>queueTwo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>topicExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>TOPIC_ROUTING_KEY_TWO<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 主题模式绑定队列3
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Binding</span> <span class="token function">topicBinding3</span><span class="token punctuation">(</span><span class="token class-name">Queue</span> queueThree<span class="token punctuation">,</span> <span class="token class-name">TopicExchange</span> topicExchange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">BindingBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>queueThree<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">to</span><span class="token punctuation">(</span>topicExchange<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>TOPIC_ROUTING_KEY_THREE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br></div></div><p>可以看到这里使用了一个比较陌生的注解：</p> <ul><li><p><code>@Slf4j</code> ：这是 Lombok 插件中一个常用注解，当需要输出一些日志消息的时候，如果不想每次都写</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>类名<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这样臃肿且没有技术含量的 <strong>样板式代码</strong> ，就可以使用 <code>@Slf4j</code> 代码。添加 <code>@Slf4j</code> 注解的类，可以直接使用</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>输出日志信息。例如：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, shiyanlou.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>或者</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Stirng</span> name <span class="token operator">=</span> <span class="token string">&quot;shiyanlou&quot;</span><span class="token punctuation">;</span>
log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, my name is {}.&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Lombok 里面的一些注解就是为了消除这样的样板式代码，在后面还会有介绍。官方文档 <a href="https://projectlombok.org/api/lombok/extern/slf4j/Slf4j.html" target="_blank" rel="noopener noreferrer">Annotation Type Slf4j<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h2 id="编写消息处理类"><a href="#编写消息处理类" class="header-anchor">#</a> 编写消息处理类</h2> <p>在我们的讲解中，仅讲解 <code>com.example.mq.rabbitmq.handler</code> 下直接模式的代码 <code>DirectQueueOneHandler.java</code> ，其它的代码几乎一样。</p> <p>当消息抵达 RabbitMQ 的队列中时，某个方法应该被调用，这个方法用于进行消息的监听，在消息被消费者消费以后，进行消息确认。对这样的方法，添加 <code>@RabbitListener(queues = 队列名)</code> 注解。队列名是这个方法所监听的消息队列的名称。具体代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>handler</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>constants<span class="token punctuation">.</span></span><span class="token class-name">RabbitConsts</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>message<span class="token punctuation">.</span></span><span class="token class-name">MessageStruct</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">Channel</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Message</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RabbitHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RabbitListener</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>DIRECT_MODE_QUEUE_ONE<span class="token punctuation">)</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DirectQueueOneHandler</span> <span class="token punctuation">{</span>

    <span class="token comment">// @RabbitHandler</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">directHandlerAutoAck</span><span class="token punctuation">(</span><span class="token class-name">MessageStruct</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;直接队列处理器，接收消息：{}&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitHandler</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">directHandlerManualAck</span><span class="token punctuation">(</span><span class="token class-name">MessageStruct</span> messageStruct<span class="token punctuation">,</span> <span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token class-name">Channel</span> channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//  如果手动ACK,消息会被监听消费,但是消息在队列中依旧存在,如果 未配置 acknowledge-mode 默认是会在消费完毕后自动ACK掉</span>
        <span class="token keyword">final</span> <span class="token keyword">long</span> deliveryTag <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;直接队列1，手动ACK，接收消息：{}&quot;</span><span class="token punctuation">,</span> messageStruct<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 通知 MQ 消息已被成功消费,可以ACK了</span>
            channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>deliveryTag<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment">// 处理失败,重新压入MQ</span>
                channel<span class="token punctuation">.</span><span class="token function">basicRecover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h2 id="rabbitmqconfig"><a href="#rabbitmqconfig" class="header-anchor">#</a> RabbitMQConfig</h2> <p>在src/main/java/com/shiyanlou/中新建RabbitConfig用来配置 RabbitMQ，比如创建队列，创建 Exchange 等。这里我们采用发布/订阅模式，所以我们建立了一个 Exchange 和两个队列。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package com.shiyanlou;

import org.springframework.amqp.core.Binding;
import org.springframework.amqp.core.BindingBuilder;
import org.springframework.amqp.core.FanoutExchange;
import org.springframework.amqp.core.Queue;
import org.springframework.context.annotation.Bean;
import org.springframework.stereotype.Component;

/**
 * @author shiyanlou
 */
@Component
public class RabbitConfig {

    @Bean
    public Queue queueA() {
        return new Queue(&quot;queueA&quot;);
    }

    @Bean
    public Queue queueB() {
        return new Queue(&quot;queueB&quot;);
    }

    /**
     * 建立一个fanout模式的Exchange
     *
     * @return
     */
    @Bean
    FanoutExchange fanoutExchange() {
        return new FanoutExchange(&quot;fanoutExchange&quot;);
    }

    /**
     * 绑定队列A到交换机
     *
     * @param queueA
     * @param fanoutExchange
     * @return
     */
    @Bean
    public Binding bindingQueueA(Queue queueA, FanoutExchange fanoutExchange) {
        return BindingBuilder.bind(queueA).to(fanoutExchange);
    }

    /**
     * 绑定队列A到交换机
     *
     * @param queueB
     * @param fanoutExchange
     * @return
     */
    @Bean
    public Binding bindingQueueB(Queue queueB, FanoutExchange fanoutExchange) {
        return BindingBuilder.bind(queueB).to(fanoutExchange);
    }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h2 id="创建提供者"><a href="#创建提供者" class="header-anchor">#</a> 创建提供者</h2> <p>在src/main/java/com/shiyanlou/中新建Provider用于生产消息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package com.shiyanlou;

import org.springframework.amqp.core.AmqpTemplate;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

/**
 * @author shiyanlou
 */
@Component
public class Provider {

    @Autowired
    private AmqpTemplate amqpTemplate;

    public void sendMessage(String msg){
        System.out.println(&quot;提供者 发送消息：&quot; + msg);
        amqpTemplate.convertAndSend(&quot;fanoutExchange&quot;,&quot;&quot;, msg);
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="创建消费者"><a href="#创建消费者" class="header-anchor">#</a> 创建消费者</h2> <p>在src/main/java/com/shiyanlou/中新建Consumer用于消费消息</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package com.shiyanlou;

import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

/**
 * @author shiyanlou
 */
@Component
public class Consumer {

    @RabbitListener(queues = &quot;queueA&quot;)
    public void receiveQueueA(String msg){
        System.out.println(&quot;消费者 queueA 收到消息：&quot; + msg);
    }

    @RabbitListener(queues = &quot;queueB&quot;)
    public void receiveQueueB(String msg){
        System.out.println(&quot;消费者 queueB 收到消息：&quot; + msg);
    }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="添加-spring-boot-启动类"><a href="#添加-spring-boot-启动类" class="header-anchor">#</a> 添加 Spring Boot 启动类</h2> <h3 id="第一种-2"><a href="#第一种-2" class="header-anchor">#</a> 第一种</h3> <p>在 <code>com.example.mq.rabbitmq</code> 下添加启动类 <code>RabbitmqdemoApplication.java</code> ：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitmqdemoApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">RabbitmqdemoApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>启动类在后面的实验中，除了类名和 package 不一致，其他部分完全相同，我们就不特别去讲解。同学们在坐后面的实验时，记得自行修改启动类。</p> <h3 id="第二种-2"><a href="#第二种-2" class="header-anchor">#</a> 第二种</h3> <p>在src/main/java/com/shiyanlou新建 SpringBoot 启动类RabbitApplication.java</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>package com.shiyanlou;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class RabbitApplication {

    public static void main(String[] args) {
        SpringApplication.run(RabbitApplication.class, args);
    }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="单元测试"><a href="#单元测试" class="header-anchor">#</a> 单元测试</h2> <h3 id="第一种-3"><a href="#第一种-3" class="header-anchor">#</a> 第一种</h3> <p>到目前为止，已经将所需的所有配置配置完毕了，接下来就可以向 RabbitMQ 中发送消息了。RabbitMQ 发送消息使用的是 <code>RabbitTemplate</code> 中的 <code>send()</code> 和 <code>converAndSend()</code> 方法。在此列举出一些用法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 发送原始的消息</span>
<span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AmqpException</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">String</span> routingKey<span class="token punctuation">,</span> <span class="token class-name">Message</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AmqpException</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">String</span> exchange<span class="token punctuation">,</span> <span class="token class-name">String</span> routingKey<span class="token punctuation">,</span> <span class="token class-name">Message</span> message<span class="token punctuation">)</span>
                    <span class="token keyword">throws</span> <span class="token class-name">AmqpException</span><span class="token punctuation">;</span>

<span class="token comment">// 发送根据对象转换而成的消息</span>
<span class="token keyword">void</span> <span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">Object</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AmqpException</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">String</span> routingKey<span class="token punctuation">,</span> <span class="token class-name">Object</span> message<span class="token punctuation">)</span>
                    <span class="token keyword">throws</span> <span class="token class-name">AmqpException</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">String</span> exchange<span class="token punctuation">,</span> <span class="token class-name">String</span> routingKey<span class="token punctuation">,</span>
                    <span class="token class-name">Object</span> message<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">AmqpException</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>可以看到，前三个 <code>send()</code> 方法直接发送了原始的 <code>Message</code> 对象， 后面三个 <code>convertAndSend()</code> 方法接受了一个对象，然后在后台将其转换为 <code>Message</code> 对象。</p> <p>在此直接演示 <code>convertAndSend()</code> 方法的使用。配置一个非 Message 的消息对象类 <code>MessageStruct</code> ，代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>message</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Builder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Serializable</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Builder</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MessageStruct</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">392365881428311040L</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>这里也出现了的 Lombok 的几个注解，分别作一些解释：</p> <ul><li><code>@Data</code> ：Java 的封装特性要求我们对类中的 <code>private</code> 类型的属性要写 getter/setter 这种方法，而使用 <code>@Data</code> 注解标注以后，就只需要在类中配置好属性名就可以了。除了 getter/setter 之外还实现的方法，同学们可以参考官方说明：<a href="https://projectlombok.org/api/lombok/Data.html" target="_blank" rel="noopener noreferrer">Annotation Type Data<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>@NoArgsConstructor</code> ：这个注解生成该类的无参构造器。<a href="https://projectlombok.org/api/lombok/NoArgsConstructor.html" target="_blank" rel="noopener noreferrer">Annotation Type NoArgsConstructor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>@AllArgsConstructor</code> ：这个注解生成了该类的全参构造器。<a href="https://projectlombok.org/api/lombok/AllArgsConstructor.html" target="_blank" rel="noopener noreferrer">Annotation Type AllArgsConstructor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>@Builder</code> ：将该类转变为建造者模式。关于建造者模式，需要同学们自己下去了解 <a href="https://projectlombok.org/api/lombok/Builder.html" target="_blank" rel="noopener noreferrer">Annotation Type Builder<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>在 <code>com.example.mq.rabbitmq</code> 中新建一个测试类 <code>RabbitmqdemoApplicationTests.java</code> 来发送消息，具体代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>constants<span class="token punctuation">.</span></span><span class="token class-name">RabbitConsts</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>mq<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>message<span class="token punctuation">.</span></span><span class="token class-name">MessageStruct</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>rabbit<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RabbitTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitmqdemoApplicationTests</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 测试直接模式发送
     */</span>
    <span class="token annotation punctuation">@org.junit.Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendDirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>DIRECT_MODE_QUEUE_ONE<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MessageStruct</span><span class="token punctuation">(</span><span class="token string">&quot;direct message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 测试分列模式发送
     */</span>
    <span class="token annotation punctuation">@org.junit.Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendFanout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>FANOUT_MODE_QUEUE<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MessageStruct</span><span class="token punctuation">(</span><span class="token string">&quot;fanout message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 测试主题模式发送1
     */</span>
    <span class="token annotation punctuation">@org.junit.Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendTopic1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>TOPIC_MODE_QUEUE<span class="token punctuation">,</span> <span class="token string">&quot;queue.aaa.bbb&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MessageStruct</span><span class="token punctuation">(</span><span class="token string">&quot;topic message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 测试主题模式发送2
     */</span>
    <span class="token annotation punctuation">@org.junit.Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendTopic2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>TOPIC_MODE_QUEUE<span class="token punctuation">,</span> <span class="token string">&quot;ccc.queue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MessageStruct</span><span class="token punctuation">(</span><span class="token string">&quot;topic message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 测试主题模式发送3
     */</span>
    <span class="token annotation punctuation">@org.junit.Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendTopic3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token class-name">RabbitConsts</span><span class="token punctuation">.</span>TOPIC_MODE_QUEUE<span class="token punctuation">,</span> <span class="token string">&quot;3.queue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">MessageStruct</span><span class="token punctuation">(</span><span class="token string">&quot;topic message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><p>然后输入以下的命令，运行测试类：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> spring-boot-mq-rabbitmq
mvn <span class="token builtin class-name">test</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>最终可以看到程序正确运行的结果，在测试类中发送的消息成功地被监听器捕获到了：</p> <p><img src="https://doc.shiyanlou.com/courses/3055/1468386/de9b675ddaad729f9366cb5b936e9bb3-0" alt="图片描述"></p> <h3 id="第二种-3"><a href="#第二种-3" class="header-anchor">#</a> 第二种</h3> <p>一切准备就绪后，我们需要编写单元测试，来检查是否程序是否可以正常运行。在·src/test/java下新建RabbitApplicationTests</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import com.shiyanlou.Provider;
import com.shiyanlou.RabbitApplication;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest(classes = RabbitApplication.class)
public class RabbitApplicationTests {

    @Autowired
    private Provider provider;

    @Test
    public void providerTest() {
        provider.sendMessage(&quot;Hello Shiyanlou&quot;);
    }

}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>运行单元测试</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>cd /home/project/rabbit
mvn test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://doc.shiyanlou.com/document-uid441493labid8432timestamp1548916339724.png/wm" alt="img"></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/matheusblog/assets/js/app.f5c8b815.js" defer></script><script src="/matheusblog/assets/js/2.07d659a0.js" defer></script><script src="/matheusblog/assets/js/183.fb30b0e8.js" defer></script>
  </body>
</html>
