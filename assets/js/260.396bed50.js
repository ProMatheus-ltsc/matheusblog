(window.webpackJsonp=window.webpackJsonp||[]).push([[260],{1538:function(e,a,t){"use strict";t.r(a);var s=t(65),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"docker-image"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-image"}},[e._v("#")]),e._v(" Docker-Image")]),e._v(" "),t("p",[e._v("镜像作为 Docker 三大核心概念中，最重要的一个关键词，它有很多操作，是您想学习容器技术不得不掌握的。")]),e._v(" "),t("h3",{attrs:{id:"目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[e._v("#")]),e._v(" 目录")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#docker-image"}},[e._v("Docker-Image")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E7%9B%AE%E5%BD%95"}},[e._v("目录")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%80-docker-%E4%B8%8B%E8%BD%BD%E9%95%9C%E5%83%8F"}},[e._v("一 Docker 下载镜像")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#11-%E4%B8%8B%E8%BD%BD%E9%95%9C%E5%83%8F"}},[e._v("1.1 下载镜像")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#12-%E9%AA%8C%E8%AF%81"}},[e._v("1.2 验证")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#13-%E4%B8%8B%E8%BD%BD%E9%95%9C%E5%83%8F%E7%9B%B8%E5%85%B3%E7%BB%86%E8%8A%82"}},[e._v("1.3 下载镜像相关细节")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#14-pull-%E5%AD%90%E5%91%BD%E4%BB%A4"}},[e._v("1.4 PULL 子命令")])])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#%E4%BA%8C-docker-%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E4%BF%A1%E6%81%AF"}},[e._v("二 Docker 查看镜像信息")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#21-images-%E5%91%BD%E4%BB%A4%E5%88%97%E5%87%BA%E9%95%9C%E5%83%8F"}},[e._v("2.1 images 命令列出镜像")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#22-%E4%BD%BF%E7%94%A8-tag-%E5%91%BD%E4%BB%A4%E4%B8%BA%E9%95%9C%E5%83%8F%E6%B7%BB%E5%8A%A0%E6%A0%87%E7%AD%BE"}},[e._v("2.2 使用 tag 命令为镜像添加标签")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#23-%E4%BD%BF%E7%94%A8-inspect-%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"}},[e._v("2.3 使用 inspect 命令查看镜像详细信息")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#24-%E4%BD%BF%E7%94%A8-history-%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E5%8E%86%E5%8F%B2"}},[e._v("2.4 使用 history 命令查看镜像历史")])])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%89-docker-%E6%90%9C%E7%B4%A2%E9%95%9C%E5%83%8F"}},[e._v("三 Docker 搜索镜像")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#31-search-%E5%91%BD%E4%BB%A4"}},[e._v("3.1 search 命令")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#32-search-%E5%AD%90%E5%91%BD%E4%BB%A4"}},[e._v("3.2 search 子命令")])])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#%E5%9B%9B-docker-%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F"}},[e._v("四 Docker 删除镜像")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#41-%E9%80%9A%E8%BF%87%E6%A0%87%E7%AD%BE%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F"}},[e._v("4.1 通过标签删除镜像")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#42-%E9%80%9A%E8%BF%87-id-%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F"}},[e._v("4.2 通过 ID 删除镜像")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#43-%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F%E7%9A%84%E9%99%90%E5%88%B6"}},[e._v("4.3 删除镜像的限制")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#44-%E6%B8%85%E7%90%86%E9%95%9C%E5%83%8F"}},[e._v("4.4 清理镜像")])])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#%E4%BA%94-docker-%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F"}},[e._v("五 Docker 创建镜像")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#51-%E5%9F%BA%E4%BA%8E%E5%B7%B2%E6%9C%89%E7%9A%84%E9%95%9C%E5%83%8F%E5%88%9B%E5%BB%BA"}},[e._v("5.1 基于已有的镜像创建")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#52-%E5%9F%BA%E4%BA%8E-dockerfile-%E5%88%9B%E5%BB%BA"}},[e._v("5.2 基于 Dockerfile 创建")])])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#%E5%85%AD-docker-%E5%AF%BC%E5%87%BA%E5%8A%A0%E8%BD%BD%E9%95%9C%E5%83%8F"}},[e._v("六 Docker 导出&加载镜像")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#61-%E5%AF%BC%E5%87%BA%E9%95%9C%E5%83%8F"}},[e._v("6.1 导出镜像")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#62-%E5%8A%A0%E8%BD%BD%E9%95%9C%E5%83%8F"}},[e._v("6.2 加载镜像")])])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%83-docker-%E4%B8%8A%E4%BC%A0%E9%95%9C%E5%83%8F"}},[e._v("七 Docker 上传镜像")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#71-%E8%8E%B7%E5%8F%96-docker-id"}},[e._v("7.1 获取 Docker ID")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#72-%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"}},[e._v("7.2 创建镜像仓库")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#73-%E4%B8%8A%E4%BC%A0%E9%95%9C%E5%83%8F"}},[e._v("7.3 上传镜像")])])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#%E5%85%AB-%E6%80%BB%E7%BB%93"}},[e._v("八 总结")])])])])]),e._v(" "),t("h2",{attrs:{id:"一-docker-下载镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-docker-下载镜像"}},[e._v("#")]),e._v(" 一 Docker 下载镜像")]),e._v(" "),t("p",[e._v("如果我们想要在本地运行容器，就必须保证本地存在对应的镜像。所以，第一步，我们需要下载镜像。当我们尝试下载镜像时，Docker 会尝试先从默认的镜像仓库（默认使用 Docker Hub 公共仓库）去下载，当然了，用户也可以自定义配置想要下载的镜像仓库。")]),e._v(" "),t("h3",{attrs:{id:"_1-1-下载镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-下载镜像"}},[e._v("#")]),e._v(" 1.1 下载镜像")]),e._v(" "),t("p",[e._v("镜像是运行容器的前提，我们可以使用 "),t("code",[e._v("docker pull[IMAGE_NAME]:[TAG]")]),e._v("命令来下载镜像，其中 "),t("code",[e._v("IMAGE_NAME")]),e._v(" 表示的是镜像的名称，而 "),t("code",[e._v("TAG")]),e._v(" 是镜像的标签，也就是说我们需要通过 “"),t("strong",[e._v("镜像 + 标签")]),e._v("” 的方式来下载镜像。")]),e._v(" "),t("p",[t("strong",[e._v("注意：")]),e._v(" 您也可以不显式地指定 TAG, 它会默认下载 latest 标签，也就是下载仓库中最新版本的镜像。这里并不推荐您下载 latest 标签，因为该镜像的内容会跟踪镜像的最新版本，并随之变化，所以它是不稳定的。在生产环境中，可能会出现莫名其妙的 bug, 推荐您最好还是显示的指定具体的 TAG。")]),e._v(" "),t("p",[e._v("举个例子，如我们想要下载一个 Mysql 5.7 镜像，可以通过命令来下载：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker pull mysql:5.7\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("会看到控制台输出内容如下：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPaaGfBRjupMm7dg74uP4a4jx1QeMY7PAHmqjFRYMkbsiaY0hZV3371uw/?wx_fmt=jpeg",alt:"Docker 下载镜像"}})]),e._v(" "),t("p",[t("strong",[e._v("注意：")]),e._v(" 由于官方 DockerHub 仓库服务器在国外，下载速度较慢，所以我将仓库的地址更改成了国内的 "),t("code",[e._v("docker.io")]),e._v(" 的镜像仓库，所以在上图中，镜像前面会有 "),t("code",[e._v("docker.io")]),e._v(" 出现。")]),e._v(" "),t("p",[e._v("当有 "),t("strong",[e._v("Downloaded")]),e._v(" 字符串输出的时候，说明下载成功了！！")]),e._v(" "),t("h3",{attrs:{id:"_1-2-验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-验证"}},[e._v("#")]),e._v(" 1.2 验证")]),e._v(" "),t("p",[e._v("让我们来验证一下，本地是否存在 Mysql5.7 的镜像，运行命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker images\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTP0QbqA4STORwmkmv1OcZM8n8BiarCrWxGiayXFdMVGlvGjv7NUFNDWpHQ/?wx_fmt=jpeg",alt:"验证本地镜像是否存在"}})]),e._v(" "),t("p",[e._v("可以看到本地的确存在该镜像，确实是下载成功了！")]),e._v(" "),t("h3",{attrs:{id:"_1-3-下载镜像相关细节"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-下载镜像相关细节"}},[e._v("#")]),e._v(" 1.3 下载镜像相关细节")]),e._v(" "),t("p",[e._v("再说说上面下载镜像的过程：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPKgsXuhayxmKjVSb5kkEB0ffKjUq2TB0FLA0Tqu7kIibRiawRP0afUcVA/?wx_fmt=jpeg",alt:"Docker 镜像下载"}})]),e._v(" "),t("p",[e._v("通过下载过程，可以看到，一个镜像一般是由多个层（ "),t("code",[e._v("layer")]),e._v("） 组成，类似 "),t("code",[e._v("f7e2b70d04ae")]),e._v("这样的串表示层的唯一 ID（实际上完整的 ID 包括了 256 个 bit, 64 个十六进制字符组成）。")]),e._v(" "),t("p",[t("strong",[e._v("您可能会想，如果多个不同的镜像中，同时包含了同一个层（ layer）,这样重复下载，岂不是导致了存储空间的浪费么?")])]),e._v(" "),t("p",[e._v("实际上，Docker 并不会这么傻会去下载重复的层（ "),t("code",[e._v("layer")]),e._v("）,Docker 在下载之前，会去检测本地是否会有同样 ID 的层，如果本地已经存在了，就直接使用本地的就好了。")]),e._v(" "),t("p",[t("strong",[e._v("另一个问题，不同仓库中，可能也会存在镜像重名的情况发生, 这种情况咋办？")])]),e._v(" "),t("p",[e._v("严格意义上，我们在使用 "),t("code",[e._v("docker pull")]),e._v(" 命令时，还需要在镜像前面指定仓库地址( "),t("code",[e._v("Registry")]),e._v("), 如果不指定，则 Docker 会使用您默认配置的仓库地址。例如上面，由于我配置的是国内 "),t("code",[e._v("docker.io")]),e._v(" 的仓库地址，我在 "),t("code",[e._v("pull")]),e._v(" 的时候，docker 会默认为我加上 "),t("code",[e._v("docker.io/library")]),e._v(" 的前缀。")]),e._v(" "),t("p",[e._v("如：当我执行 "),t("code",[e._v("docker pull mysql:5.7")]),e._v(" 命令时，实际上相当于 "),t("code",[e._v("docker pull docker.io/mysql:5.7")]),e._v("，如果您未自定义配置仓库，则默认在下载的时候，会在镜像前面加上 DockerHub 的地址。")]),e._v(" "),t("p",[e._v("Docker 通过前缀地址的不同，来保证不同仓库中，重名镜像的唯一性。")]),e._v(" "),t("h3",{attrs:{id:"_1-4-pull-子命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-pull-子命令"}},[e._v("#")]),e._v(" 1.4 PULL 子命令")]),e._v(" "),t("p",[e._v("命令行中输入：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker pull --help\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("会得到如下信息：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[root@iZbp1j8y1bab0djl9gdp33Z ~]# docker pull --help\nUsage:  docker pull [OPTIONS] NAME[:TAG|@DIGEST]\nPull an image or a repository from a registry\nOptions:  -a, --all-tags                Download all tagged images in the repository      --disable-content-trust   Skip image verification (default true)      --help                    Print usage\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[e._v("我们可以看到主要支持的子命令有：")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("-a,--all-tags=true|false")]),e._v(": 是否获取仓库中所有镜像，默认为否；")]),e._v(" "),t("li",[t("code",[e._v("--disable-content-trust")]),e._v(": 跳过镜像内容的校验，默认为 true;")])]),e._v(" "),t("h2",{attrs:{id:"二-docker-查看镜像信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-docker-查看镜像信息"}},[e._v("#")]),e._v(" 二 Docker 查看镜像信息")]),e._v(" "),t("h3",{attrs:{id:"_2-1-images-命令列出镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-images-命令列出镜像"}},[e._v("#")]),e._v(" 2.1 images 命令列出镜像")]),e._v(" "),t("p",[e._v("通过使用如下两个命令，列出本机已有的镜像：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker images\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("或：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker image ls\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("如下图所示：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPo7bVaeYBiajiaZdfIN4J4D10WJ04W2zicZouiceKlDUbbte216HpCgErmQ/?wx_fmt=jpeg",alt:"Docker 查看镜像信息"}})]),e._v(" "),t("p",[e._v("对上述红色标注的字段做一下解释：")]),e._v(" "),t("ul",[t("li",[t("strong",[e._v("REPOSITORY")]),e._v(": 来自于哪个仓库；")]),e._v(" "),t("li",[t("strong",[e._v("TAG")]),e._v(": 镜像的标签信息，比如 5.7、latest 表示不同的版本信息；")]),e._v(" "),t("li",[t("strong",[e._v("IMAGE ID")]),e._v(": 镜像的 ID, 如果您看到两个 ID 完全相同，那么实际上，它们指向的是同一个镜像，只是标签名称不同罢了；")]),e._v(" "),t("li",[t("strong",[e._v("CREATED")]),e._v(": 镜像最后的更新时间；")]),e._v(" "),t("li",[t("strong",[e._v("SIZE")]),e._v(": 镜像的大小，优秀的镜像一般体积都比较小，这也是我更倾向于使用轻量级的 alpine 版本的原因；")])]),e._v(" "),t("blockquote",[t("p",[e._v("注意：图中的镜像大小信息只是逻辑上的大小信息，因为一个镜像是由多个镜像层（ "),t("code",[e._v("layer")]),e._v("）组成的，而相同的镜像层本地只会存储一份，所以，真实情况下，占用的物理存储空间大小，可能会小于逻辑大小。")])]),e._v(" "),t("h3",{attrs:{id:"_2-2-使用-tag-命令为镜像添加标签"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-使用-tag-命令为镜像添加标签"}},[e._v("#")]),e._v(" 2.2 使用 tag 命令为镜像添加标签")]),e._v(" "),t("p",[e._v("通常情况下，为了方便在后续工作中，快速地找到某个镜像，我们可以使用 "),t("code",[e._v("docker tag")]),e._v(" 命令，为本地镜像添加一个新的标签。如下图所示：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPD2huWAicJUMBNZhf56OHXa0KjiaF2XcUvxyMm3mssibKvKa5UayFcD1WQ/?wx_fmt=jpeg",alt:"Docker tag 添加标签"}})]),e._v(" "),t("p",[e._v("为 "),t("code",[e._v("docker.io/mysql")]),e._v(" 镜像，添加新的镜像标签 "),t("code",[e._v("allen_mysql:5.7")]),e._v("。然后使用 "),t("code",[e._v("docker images")]),e._v(" 命令，查看本地镜像：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPCDq6MvlhsiawBwhNn7OEwJassCnwjibP4gWwqAvG3xow9LwFf2ticUsdg/?wx_fmt=jpeg",alt:"Docker tag 添加标签"}})]),e._v(" "),t("p",[e._v("可以看到，本地多了一个 "),t("code",[e._v("allen_mysql:5.7")]),e._v(" 的镜像。细心的你一定还会发现， "),t("code",[e._v("allen_mysql:5.7")]),e._v(" 和 "),t("code",[e._v("docker.io/mysql:5.7")]),e._v(" 的镜像 ID 是一模一样的，说明它们是同一个镜像，只是别名不同而已。")]),e._v(" "),t("p",[t("code",[e._v("docker tag")]),e._v(" 命令功能更像是, 为指定镜像添加快捷方式一样。")]),e._v(" "),t("h3",{attrs:{id:"_2-3-使用-inspect-命令查看镜像详细信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-使用-inspect-命令查看镜像详细信息"}},[e._v("#")]),e._v(" 2.3 使用 inspect 命令查看镜像详细信息")]),e._v(" "),t("p",[e._v("通过 "),t("code",[e._v("docker inspect")]),e._v(" 命令，我们可以获取镜像的详细信息，其中，包括创建者，各层的数字摘要等。")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker inspect docker.io/mysql:5.7\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPzL9a3cEkXSh4uuSSwia4pibNjT4dDV7t1AgFuJkrBAq3CkU2WWorEFdg/?wx_fmt=jpeg",alt:"Docker inspect 查看镜像详细信息"}})]),e._v(" "),t("p",[t("code",[e._v("docker inspect")]),e._v(" 返回的是 "),t("code",[e._v("JSON")]),e._v(" 格式的信息，如果您想获取其中指定的一项内容，可以通过 "),t("code",[e._v("-f")]),e._v(" 来指定，如获取镜像大小：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('docker inspect -f {{".Size"}} docker.io/mysql:5.7\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPsa7t1OSDhWgFxEzCdfyNaOduGmsz7xJEobUZFibzw5UFxmKvrcmwGNA/?wx_fmt=jpeg",alt:"Docker inspect 查看镜像详细信息"}})]),e._v(" "),t("h3",{attrs:{id:"_2-4-使用-history-命令查看镜像历史"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-使用-history-命令查看镜像历史"}},[e._v("#")]),e._v(" 2.4 使用 history 命令查看镜像历史")]),e._v(" "),t("p",[e._v("前面的小节中，我们知道了，一个镜像是由多个层（layer）组成的，那么，我们要如何知道各个层的具体内容呢？")]),e._v(" "),t("p",[e._v("通过 "),t("code",[e._v("docker history")]),e._v(" 命令，可以列出各个层（layer）的创建信息，如我们查看 "),t("code",[e._v("docker.io/mysql:5.7")]),e._v(" 的各层信息：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker history docker.io/mysql:5.7\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPQ8F21nmOQ7RLI5ibAgVpcOkBlIRR2kH4B0VlDExiauskHbE0w0HYeE0w/?wx_fmt=jpeg",alt:"Docker history 各层信息"}})]),e._v(" "),t("p",[e._v("可以看到，上面过长的信息，为了方便展示，后面都省略了，如果您想要看具体信息，可以通过添加 "),t("code",[e._v("--no-trunc")]),e._v(" 选项，如下面命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker history --no-trunc docker.io/mysql:5.7\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"三-docker-搜索镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-docker-搜索镜像"}},[e._v("#")]),e._v(" 三 Docker 搜索镜像")]),e._v(" "),t("h3",{attrs:{id:"_3-1-search-命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-search-命令"}},[e._v("#")]),e._v(" 3.1 search 命令")]),e._v(" "),t("p",[e._v("您可以通过下面命令进行搜索：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker search [option] keyword\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("比如，您想搜索仓库中 "),t("code",[e._v("mysql")]),e._v(" 相关的镜像，可以输入如下命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker search mysql\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTP3PBGU7q2NoK6WGSRmcxWs0OMicjeDwTBFvOAbXB5MuaDFPYXAod3NZA/?wx_fmt=jpeg",alt:"Docker 搜索镜像"}})]),e._v(" "),t("h3",{attrs:{id:"_3-2-search-子命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-search-子命令"}},[e._v("#")]),e._v(" 3.2 search 子命令")]),e._v(" "),t("p",[e._v("命令行输入 "),t("code",[e._v("docker search--help")]),e._v(", 输出如下：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("Usage:  docker search [OPTIONS] TERM\nSearch the Docker Hub for images\nOptions:  -f, --filter filter   Filter output based on conditions provided      --help            Print usage      --limit int       Max number of search results (default 25)      --no-index        Don't truncate output      --no-trunc        Don't truncate output\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[e._v("可以看到 "),t("code",[e._v("search")]),e._v(" 支持的子命令有：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("-f,--filter filter")]),e._v(": 过滤输出的内容；")]),e._v(" "),t("li",[t("code",[e._v("--limitint")]),e._v("：指定搜索内容展示个数;")]),e._v(" "),t("li",[t("code",[e._v("--no-index")]),e._v(": 不截断输出内容；")]),e._v(" "),t("li",[t("code",[e._v("--no-trunc")]),e._v("：不截断输出内容；")])]),e._v(" "),t("p",[e._v("举个列子，比如我们想搜索官方提供的 mysql 镜像，命令如下：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker search --filter=is-offical=true mysql\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPup8t50skwCOEX0pwnR9uicvWZWNxc7Vv4slXzIoGLhSPcwDq51xpUGA/?wx_fmt=jpeg",alt:"Docker 搜索官方镜像"}})]),e._v(" "),t("p",[e._v("再比如，我们想搜索 Stars 数超过 100 的 mysql 镜像：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker search --filter=stars=100 mysql\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLHC3QNcSiaib3u3EM014CpBTPsbeMVBSiaLLINzVmkbG3VtIbr3XJnVbIqWKvS016Yib3WQQmraqlENGA/?wx_fmt=jpeg",alt:"Docker 搜索镜像"}})]),e._v(" "),t("h2",{attrs:{id:"四-docker-删除镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四-docker-删除镜像"}},[e._v("#")]),e._v(" 四 Docker 删除镜像")]),e._v(" "),t("h3",{attrs:{id:"_4-1-通过标签删除镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-通过标签删除镜像"}},[e._v("#")]),e._v(" 4.1 通过标签删除镜像")]),e._v(" "),t("p",[e._v("通过如下两个都可以删除镜像：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker rmi [image]\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("或者：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker image rm [image]\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("支持的子命令如下：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("-f,-force")]),e._v(": 强制删除镜像，即便有容器引用该镜像；")]),e._v(" "),t("li",[t("code",[e._v("-no-prune")]),e._v(": 不要删除未带标签的父镜像；")])]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHjMP3NiaSibZZ0XKTiasurB1giae3nfZvWZibRal7TKfiaAhJicXQfibicqCo5Kw/?wx_fmt=jpeg",alt:"Docker 查看镜像信息"}}),e._v("Docker 查看镜像信息")]),e._v(" "),t("p",[e._v("例如，我们想删除上章节创建的 "),t("code",[e._v("allen_mysql:5.7")]),e._v(" 镜像，命令如下：")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("docker")]),e._v(" rmi allen_mysql:5.7\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHfh5oDc3GDzlp7B5oaVRic7hHIzvRicDz1wCbgIBrQvMXK8jYo3yPOl5Q/?wx_fmt=jpeg",alt:"Docker 删除镜像"}})]),e._v(" "),t("p",[e._v("从上面章节中，我们知道 "),t("code",[e._v("allen_mysql:5.7")]),e._v(" 和 "),t("code",[e._v("docker.io/mysql:5.7")]),e._v(" 实际上指向的是同一个镜像，那么，您可以能会有疑问，我删除了 "),t("code",[e._v("allen_mysql:5.7")]),e._v(", 会不会将 "),t("code",[e._v("docker.io/mysql:5.7")]),e._v(" 镜像也给删除了？")]),e._v(" "),t("p",[t("strong",[e._v("实际上，当同一个镜像拥有多个标签时，执行 "),t("code",[e._v("docker rmi")]),e._v(" 命令，只是会删除了该镜像众多标签中，您指定的标签而已，并不会影响原始的那个镜像文件。")])]),e._v(" "),t("p",[e._v("不信的话，我们可以执行 "),t("code",[e._v("docker images")]),e._v(" 命令，来看下 "),t("code",[e._v("docker.io/mysql:5.7")]),e._v(" 镜像还在不在：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHiciaqjoLKZiaoVZFeLJkfA2TfUKaib2muSNrTJP2Rvicib4ac3gMXPiaBkB9Q/?wx_fmt=jpeg",alt:"Docker 查看镜像信息"}})]),e._v(" "),t("p",[e._v("可以看到， "),t("code",[e._v("docker.io/mysql:5.7")]),e._v(" 镜像依然存在！")]),e._v(" "),t("p",[e._v("那么，如果某个镜像不存在多个标签，当且仅当只有一个标签时，执行删除命令时，您就要小心了，这会彻底删除镜像。")]),e._v(" "),t("p",[e._v("例如，这个时候，我们再执行 "),t("code",[e._v("docker rmi docker.io/mysql:5.7")]),e._v(" 命令：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHAjqtv8JHovzTCdfIM5fIT5Nia3iaI7wKLo13vQgsWibRR9Y2Fd73V9czg/?wx_fmt=jpeg",alt:"Docker 删除镜像"}})]),e._v(" "),t("p",[e._v("从上图可以看到，我们已经删除了 "),t("code",[e._v("docker.io/mysql:5.7")]),e._v(" 镜像的所有文件层。该镜像在本地已不复存在了！")]),e._v(" "),t("h3",{attrs:{id:"_4-2-通过-id-删除镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-通过-id-删除镜像"}},[e._v("#")]),e._v(" 4.2 通过 ID 删除镜像")]),e._v(" "),t("p",[e._v("除了通过标签名称来删除镜像，我们还可以通过制定镜像 ID, 来删除镜像，如：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker rmi ee7cbd482336\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("一旦制定了通过 ID 来删除镜像，它会先尝试删除所有指向该镜像的标签，然后在删除镜像本身。")]),e._v(" "),t("h3",{attrs:{id:"_4-3-删除镜像的限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-删除镜像的限制"}},[e._v("#")]),e._v(" 4.3 删除镜像的限制")]),e._v(" "),t("p",[e._v("删除镜像很简单，但也不是我们何时何地都能删除的，它存在一些限制条件。")]),e._v(" "),t("p",[e._v("当通过该镜像创建的容器未被销毁时，镜像是无法被删除的。为了验证这一点，我们来做个试验。首先，我们通过 "),t("code",[e._v("docker pull alpine")]),e._v(" 命令，拉取一个最新的 "),t("code",[e._v("alpine")]),e._v(" 镜像, 然后启动镜像，让其输出 "),t("code",[e._v("hello,docker!")]),e._v(":")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHia157yicRQe5g5ad36peutDlAxuGcWbdxopEwmHXCM7rga80cYj0CguA/?wx_fmt=jpeg",alt:"Docker run alpine"}})]),e._v(" "),t("p",[e._v("接下来，我们来删除这个镜像试试：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHia5wTHrVKT1NPHFZvLicwMicKibG5VHVjEWJOXrPOG4pK5VDwAYMcAYzJg/?wx_fmt=jpeg",alt:"Docker 删除镜像"}})]),e._v(" "),t("p",[e._v("可以看到提示信息，无法删除该镜像，因为有容器正在引用他！同时，这段信息还告诉我们，除非通过添加 "),t("code",[e._v("-f")]),e._v(" 子命令，也就是强制删除，才能移除掉该镜像！")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker rmi -f docker.io/alpine\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("但是，我们一般不推荐这样暴力的做法，正确的做法应该是：")]),e._v(" "),t("ol",[t("li",[e._v("先删除引用这个镜像的容器；")]),e._v(" "),t("li",[e._v("再删除这个镜像；")])]),e._v(" "),t("p",[e._v("也就是，根据上图中提示的，引用该镜像的容器 ID ( "),t("code",[e._v("9d59e2278553")]),e._v("), 执行删除命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker rm 9d59e2278553\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("然后，再执行删除镜像的命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker rmi 5cb3aa00f899\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHWibytB1NGVzS1KBMia7sYMNm2eStNd4PicxoYA5CfQficMh4eoJMjtHiacA/?wx_fmt=jpeg",alt:"Docker 删除镜像"}}),e._v("Docker 删除镜像")]),e._v(" "),t("p",[e._v("这个时候，就能正常删除了！")]),e._v(" "),t("h3",{attrs:{id:"_4-4-清理镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-清理镜像"}},[e._v("#")]),e._v(" 4.4 清理镜像")]),e._v(" "),t("p",[e._v("我们在使用 Docker 一段时间后，系统一般都会残存一些临时的、没有被使用的镜像文件，可以通过以下命令进行清理：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker image prune\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("它支持的子命令有：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("-a,--all")]),e._v(": 删除所有没有用的镜像，而不仅仅是临时文件；")]),e._v(" "),t("li",[t("code",[e._v("-f,--force")]),e._v("：强制删除镜像文件，无需弹出提示确认；")])]),e._v(" "),t("h2",{attrs:{id:"五-docker-创建镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五-docker-创建镜像"}},[e._v("#")]),e._v(" 五 Docker 创建镜像")]),e._v(" "),t("p",[e._v("此小节中，您将学习 Docker 如何创建镜像？Docker 创建镜像主要有三种：")]),e._v(" "),t("ol",[t("li",[e._v("基于已有的镜像创建；")]),e._v(" "),t("li",[e._v("基于 Dockerfile 来创建；")]),e._v(" "),t("li",[e._v("基于本地模板来导入；")])]),e._v(" "),t("p",[e._v("我们将主要介绍常用的 1，2 两种。")]),e._v(" "),t("h3",{attrs:{id:"_5-1-基于已有的镜像创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-基于已有的镜像创建"}},[e._v("#")]),e._v(" 5.1 基于已有的镜像创建")]),e._v(" "),t("p",[e._v("通过如下命令来创建：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker container commit\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("支持的子命令如下：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("-a,--author")]),e._v('="": 作者信息；')]),e._v(" "),t("li",[t("code",[e._v("-c,--change")]),e._v("=[]: 可以在提交的时候执行 Dockerfile 指令，如 CMD、ENTRYPOINT、ENV、EXPOSE、LABEL、ONBUILD、USER、VOLUME、WORIR 等；")]),e._v(" "),t("li",[t("code",[e._v("-m,--message")]),e._v('="": 提交信息；')]),e._v(" "),t("li",[t("code",[e._v("-p,--pause")]),e._v("=true: 提交时，暂停容器运行。")])]),e._v(" "),t("p",[e._v("接下来，基于本地已有的 Ubuntu 镜像，创建一个新的镜像：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHMibkCiaNb1AbTNoQicVKkiaAOIhZO2FsRNbSY0kzqZezVGcfgOibJRD58QQ/?wx_fmt=jpeg",alt:"Docker 创建镜像"}})]),e._v(" "),t("p",[e._v("首先，让我将它运行起来，并在其中创建一个 test.txt 文件：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHQd7AuibW8ml35Tk90OO15s43CAHQtXx5kYzibP5vtNAwic95qibDza61BQ/?wx_fmt=jpeg",alt:"Docker 创建镜像"}})]),e._v(" "),t("p",[e._v("命令如下：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -it docker.io/ubuntu:latest /bin/bashroot@a0a0c8cfec3a:/# touch test.txtroot@a0a0c8cfec3a:/# exit\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("创建完 test.txt 文件后，需要记住标注的容器 ID: "),t("code",[e._v("a0a0c8cfec3a")]),e._v(", 用它来提交一个新的镜像("),t("strong",[e._v("PS: 你也可以通过名称来提交镜像，这里只演示通过 ID 的方式")]),e._v(")。")]),e._v(" "),t("p",[e._v("执行命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('docker container commit -m "Added test.txt file" -a "Allen" a0a0c8cfec3a test:0.1\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("提交成功后，会返回新创建的镜像 ID 信息，如下图所示：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHgX5ks187yqupLWLQnvNuwLGibc6So1xk8OZc6SpXEVB5zDEo6WlxQhw/?wx_fmt=jpeg",alt:"Docker 提交新创建的镜像"}})]),e._v(" "),t("p",[e._v("再次查看本地镜像信息，可以看到新创建的 "),t("code",[e._v("test:0.1")]),e._v(" 镜像了：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHibWZE9BBMrgVAzDAbpWibEANicPohJErNVCQpAFMfvKExoLj2EQlIYQ2g/?wx_fmt=jpeg",alt:"Docker 查看镜像信息"}})]),e._v(" "),t("h3",{attrs:{id:"_5-2-基于-dockerfile-创建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-基于-dockerfile-创建"}},[e._v("#")]),e._v(" 5.2 基于 Dockerfile 创建")]),e._v(" "),t("p",[e._v("通过 Dockerfile 的方式来创建镜像，是最常见的一种方式了，也是比较推荐的方式。Dockerfile 是一个文本指令文件，它描述了是如何基于一个父镜像，来创建一个新镜像的过程。")]),e._v(" "),t("p",[e._v("下面让我们来编写一个简单的 Dockerfile 文件，它描述了基于 Ubuntu 父镜像，安装 Python3 环境的镜像：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('FROM docker.io/ubuntu:latest\nLABEL version="1.0" maintainer="Allen <weiwosuo@github>"\nRUN apt-get update && \\    apt-get install -y python3 && \\    apt-get clean && \\    rm -rf /var/lib/apt/lists/*\n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])]),t("p",[e._v("创建完成后，通过这个 Dockerfile 文件，来构建新的镜像，执行命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker image build -t python:3 .\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("strong",[e._v("注意：")]),e._v(" 命令的最后有个点，如果不加的话，会构建不成功 ！")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHk6rCexCL5PcQqMia6QzvOicMg754BKO3mOibQCfQ6MI7tR1JA2A5ZqI7A/?wx_fmt=jpeg",alt:"Docker 通过 Dockerfile 构建镜像"}})]),e._v(" "),t("p",[e._v("编译成功后，再次查看本地镜像信息，就可以看到新构建的 python:3 镜像了。")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHH0amjBEf1pRGNUS4SbzibupypIebmiarHLotk3s1n2PdaqUPibrEaSoTvQ/?wx_fmt=jpeg",alt:"Docker 查看镜像信息"}})]),e._v(" "),t("h2",{attrs:{id:"六-docker-导出-加载镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六-docker-导出-加载镜像"}},[e._v("#")]),e._v(" 六 Docker 导出&加载镜像")]),e._v(" "),t("p",[e._v("此小节中，您将学习 Docker 如何导出&加载镜像。")]),e._v(" "),t("p",[e._v("通常我们会有下面这种需求，需要将镜像分享给别人，这个时候，我们可以将镜像导出成 tar 包，别人直接通过加载这个 tar 包，快速地将镜像引入到本地镜像库。")]),e._v(" "),t("p",[e._v("要想使用这两个功能，主要是通过如下两个命令：")]),e._v(" "),t("ol",[t("li",[t("code",[e._v("docker save")])]),e._v(" "),t("li",[t("code",[e._v("docker load")])])]),e._v(" "),t("h3",{attrs:{id:"_6-1-导出镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-导出镜像"}},[e._v("#")]),e._v(" 6.1 导出镜像")]),e._v(" "),t("p",[e._v("查看本地镜像如下：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHH0amjBEf1pRGNUS4SbzibupypIebmiarHLotk3s1n2PdaqUPibrEaSoTvQ/?wx_fmt=jpeg",alt:"Docker 查看镜像信息"}})]),e._v(" "),t("p",[e._v("例如，我们想要将 python:3 镜像导出来，执行命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker save -o python_3.tar python:3\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("执行成功后，查看当前目录：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHOzOhDgY43hbGSGena4g7YpYREdwD1pzWPanhic1pb0LmFrsNGKAYK8g/?wx_fmt=jpeg",alt:"Docker 导出文件"}}),e._v("Docker 导出文件")]),e._v(" "),t("p",[e._v("可以看到 "),t("code",[e._v("python_3.tar")]),e._v(" 镜像文件已经生成。接下来，你可以将它通过复制的方式，分享给别人了！")]),e._v(" "),t("h3",{attrs:{id:"_6-2-加载镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-加载镜像"}},[e._v("#")]),e._v(" 6.2 加载镜像")]),e._v(" "),t("p",[e._v("别人拿到了这个 "),t("code",[e._v("tar")]),e._v(" 包后，要如何导入到本地的镜像库呢？")]),e._v(" "),t("p",[e._v("通过执行如下命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker load -i python_3.tar\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("或者：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker load < python_3.tar\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("导入成功后，查看本地镜像信息，你就可以获得别人分享的镜像了！怎么样，是不是很方便呢！")]),e._v(" "),t("h2",{attrs:{id:"七-docker-上传镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#七-docker-上传镜像"}},[e._v("#")]),e._v(" 七 Docker 上传镜像")]),e._v(" "),t("p",[e._v("我们将以上传到 Docker Hub 上为示例，演示 Docker 如何上传镜像。")]),e._v(" "),t("h3",{attrs:{id:"_7-1-获取-docker-id"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-获取-docker-id"}},[e._v("#")]),e._v(" 7.1 获取 Docker ID")]),e._v(" "),t("p",[e._v("想要上传镜像到 Docker Hub 上，首先，我们需要注册 Docker Hub 账号。打开 Docker Hub 网址 https://hub.docker.com，开始注册：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHH6JticENibsia3hkfDDuBq7PtOotic7rPK46wFdotM0LUYuyFZbOVUaJoeQ/?wx_fmt=jpeg",alt:"Docker Hub 注册账号"}})]),e._v(" "),t("p",[e._v("填写您的 Docker ID (也就是账号)，以及密码，Email, 点击继续。")]),e._v(" "),t("p",[e._v("接下来，Docker Hub 会发送验证邮件，到您填写的邮箱当中：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHfedKcp34V4t351TqTfBiaRmwAbHmOnVadHydicp3MtLQnUykQYUV49FA/?wx_fmt=jpeg",alt:"Docker Hub 验证邮件"}})]),e._v(" "),t("p",[e._v("点击验证即可，接下来，再次返回 Docker Hub 官网，用您刚刚注册的 Docker ID 和密码来登录账号！")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHa5I17YSce16BNFOgNayA0iaWYWGJnHWwZUjslrBRyV1jLssDKa7mysA/?wx_fmt=jpeg",alt:"Docker Hub 登录页面"}})]),e._v(" "),t("h3",{attrs:{id:"_7-2-创建镜像仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-创建镜像仓库"}},[e._v("#")]),e._v(" 7.2 创建镜像仓库")]),e._v(" "),t("p",[e._v("登录成功后，会出现如下页面：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHRI3SFiaSl2yuXXO1CLhRDR03mVpTO4jwmljIaZC0KptcW7kmM03Xxicg/?wx_fmt=jpeg",alt:"欢迎来到 Docker Hub"}})]),e._v(" "),t("p",[e._v("选择创建一个镜像仓库：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHMsc31Uskib3SRM4uZZCqkYwyNJFN8ia4LkAKNZuurAbHJyQ1fib9DKGEw/?wx_fmt=jpeg",alt:"创建 Python 仓库"}})]),e._v(" "),t("p",[e._v("填写"),t("strong",[e._v("仓库名称")]),e._v("、"),t("strong",[e._v("描述信息")]),e._v("、"),t("strong",[e._v("是否公开后")]),e._v("，点击创建。")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHH688icujdAHnPOcHEaATxupbOn4u7LSKEBKoDWb1dPISiaP757VBibdwGQ/?wx_fmt=jpeg",alt:"仓库镜像展示页"}}),e._v("仓库镜像展示页")]),e._v(" "),t("p",[e._v("我们看到，仓库已经创建成功了，但是里面还没有任何镜像，接下来开始上传镜像，到此新创建的仓库中。")]),e._v(" "),t("h3",{attrs:{id:"_7-3-上传镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-上传镜像"}},[e._v("#")]),e._v(" 7.3 上传镜像")]),e._v(" "),t("p",[e._v("进入命令行，"),t("strong",[e._v("用我们刚刚获取的 Docker ID 以及密码登录")]),e._v("，执行命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker login\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHsJNOaXDpy3C4vu3xPOQUA9XfYFiasZOs69PLOxpUSiaGvEicYib3WKm88Q/?wx_fmt=jpeg",alt:"命令行登录 Docker ID"}}),e._v("命令行登录 Docker ID")]),e._v(" "),t("p",[e._v("登录成功后，我们开始准备上传本地的 "),t("code",[e._v("python:3")]),e._v(" 镜像：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHNNakMbCH4TFQTT0iad9Eb2vde8JzfgwIXFLpiaKzeMAYIa7ft22wBMEA/?wx_fmt=jpeg",alt:"python:3 镜像"}})]),e._v(" "),t("p",[e._v("首先，我们对其打一个新的标签，"),t("strong",[e._v("前缀与我们新创建的 Docker ID 、仓库名保持一致")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker tag python:3 weiwosuoai1991/python:3\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHSl8ria0e1kFFWlI1gAwwszV28IkztLv0s9XSZG6ficYIAoO1mfo4LrmQ/?wx_fmt=jpeg",alt:"python:3 镜像打标签"}})]),e._v(" "),t("p",[e._v("查看本地信息，可以看到，标签打成功了。接下开，开始上传！执行命令：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker push weiwosuoai1991/python:3\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHHeiaV2FtSpv7ewkpyOLEo7e6No42GSbCLqfaxjUicnFhBEq7m4OyIR6GA/?wx_fmt=jpeg",alt:"上传 python:3 镜像"}})]),e._v(" "),t("p",[e._v("上传成功！去 Docker Hub 官网，新创建的仓库的信息页面验证一下，是否真的成功了：")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/knmrNHnmCLFSKI1RxMqyrVlVX4GRveHH5ibFBuhibrBn6Xe9tgxgO7LxtXI9FJ0HtLjvuibJhBqZPyexWY78MmBiag/?wx_fmt=jpeg",alt:"仓库镜像展示页"}}),e._v("仓库镜像展示页")]),e._v(" "),t("p",[e._v("大工告成！！！")]),e._v(" "),t("h2",{attrs:{id:"八-总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#八-总结"}},[e._v("#")]),e._v(" 八 总结")]),e._v(" "),t("p",[e._v("本文中，我们着重学习了 Docker 中下载镜像,、查看镜像信息、搜索镜像、删除镜像,、创建镜像、导出&加载镜像以及向 Docker Hub 上传镜像的相关操作。")])])}),[],!1,null,null,null);a.default=r.exports}}]);